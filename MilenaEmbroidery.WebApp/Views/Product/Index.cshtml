
@model IEnumerable<ProductDTO>
@{
    ViewData["Title"] = "Home page";
}

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
</div>

<div id="products">
    <div id="vue" class="esh-catalog-items row">
        <parameter-list :parametr="parameter"
                        v-for="parameter in parameters">
        </parameter-list>
    </div>
</div>

@section Scripts {
    <template id="list">
        <div class="esh-catalog-item col-md-4">
            <img class="esh-catalog-thumbnail" v-bind:src="parametr.pictureLink"  width="200" height="200" />
            <input class="esh-catalog-button" type="submit" value="[ ADD TO BASKET ]" />
            <div class="esh-catalog-name">
                <span>{{parametr.name}}</span>
            </div>
            <div class="esh-catalog-price">
                <span>{{parametr.price}}</span>
            </div>
            <div v-if="parametr.isLimited">
                <span>{{parametr.countLimited}}</span>
            </div>
        </div>
    </template>

    <script>
        Vue.component('parameter-list', {
            props: ['parametr'],
            template: '#list'
        });

        var vue = new Vue({
            el: '#vue',
            data: {
                parameters: []
            },
            mounted() {
                this.loadData()
            },
            methods: {
                loadData() {
                    axios({
                        method: 'get',
                        url: '/Product/Get',
                    }).then(response => {
                        this.parameters = response.data
                    }).catch (error => {
                        console.log(error.response.data)
                        let message = error.response.data + "\n\n" + error.response.status;
                        window.alert(message);
                    })
                }
            }
        });
    </script>
}
